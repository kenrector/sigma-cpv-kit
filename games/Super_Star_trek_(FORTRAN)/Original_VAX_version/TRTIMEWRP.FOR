      SUBROUTINE TIMEWRP
	INCLUDE 'TREKCOM/NOLIST'
      DIMENSION PICTURE(226)
      EQUIVALENCE (PICTURE,DATE)
      CALL PROUT(21H***TIME WARP ENTERED.,21)
      IF(SNAP.NE.0 .AND. RANF(0).LT.0.5) GO TO 10 
C--------TRAVEL FORWARD IN TIME 
      TIME=-0.5*INTIME*ALOG(RANF(0))
      CALL CRAM(35HYOU ARE TRAVELLING FORWARD IN TIME ) 
      CALL CRAMF(TIME,0,2)
      CALL CRAMDMP(11H STARDATES.)
C--------CHEAT TO MAKE SURE NO TRACTOR BEAMS OCCUR DURING TIME WARP 
      FUTURE(2)=FUTURE(2)+TIME
      GO TO 40
C--------TRAVEL BACKWARD IN TIME
 10   XDATE=DATE
      DATE=SNAPSHT(1) 
      CALL CRAM(36HYOU ARE TRAVELLING BACKWARD IN TIME )
      CALL CRAMF(XDATE-DATE,0,2)
      CALL CRAMDMP(11H STARDATES.)
      SNAP=0
      DO 20 L=2,226 
 20   PICTURE(L)=SNAPSHT(L) 
      IF(REMCOM .EQ. 0) GO TO 25
      FUTURE(2)=DATE+EXPRAN(INTIME/REMCOM)
      FUTURE(4)=DATE+EXPRAN(0.3*INTIME) 
 25   FUTURE(1)=DATE+EXPRAN(0.5*INTIME) 
      FUTURE(3)=DATE+EXPRAN(0.5*INTIME) 
      IF(NSCREM.NE.0) FUTURE(6)=0.2777
      ISATB=0 
      FUTURE(5)=1E38 
	FUTURE(7)=1E38
	BATX=0
	BATY=0
C--------REVERT STAR CHART TO EARLIER ERA.
      DO 30 L=1,8 
      DO 30 LL=1,8
 30   STARCH(L,LL)=MIN0(1,STARCH(L,LL)) 
      CALL PROUT( 
     +   57HSPOCK HAS RECONSTRUCTED A CORRECT STAR CHART FROM MEMORY.
	1 ,57)
C--------MODIFY DESTINATION QUADRANT TO CORRESPOND TO NEW TIME
 40   CALL NEWQUAD
      RETURN
      END 
