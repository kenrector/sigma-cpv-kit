      SUBROUTINE WAIT 
	INCLUDE 'TREKCOM/NOLIST'
	REAL*8 AITEM
	COMMON/SCANBF/KEY,AITEM
	EQUIVALENCE(AITEM,FNUM)
C--------DO COMMAND SCANNING
      IDIDIT=0
 10   CALL SCAN
	ANUM=FNUM		!SAVE SCAN BUFFER
      IF(KEY .NE. IHEOL) GO TO 20 
      CALL PROMPT(10HHOW LONG? ,10) 
      GO TO 10
20	IF(KEY .NE. IHREAL) GO TO 60
      IF(ANUM .LE. 0.) RETURN 
      IF(ANUM.LT.REMTIME .AND.NENHERE.EQ.0) GO TO 30 
      CALL PROMPT(13HARE YOU SURE?,13)
      IF(JA(DUMMY) .EQ. 0) RETURN 
C--------ALTERNATE REST PERIODS (EVENTS) WITH ATTACKS 
 30   RESTING=1 
      AITEM2=ANUM
 40   IF(ANUM .LE. 0.) RESTING=0
      IF(RESTING .EQ. 0) GO TO 50 
	TEMP=ANUM
      IF(NENHERE.NE. 0) TEMP=AMIN1(ANUM,1.0+RANF(0))
	TIME=TEMP
      IF(TIME .LT. ANUM) CALL ATTACK 
      IF(NENHERE.EQ.0) CALL MOVETHO   
      IF(ALLDONE.NE.0) RETURN 
      CALL EVENTS 
      IDIDIT=1
      IF(ALLDONE.NE.0) RETURN 
      ANUM=ANUM-TEMP
      IF(GALAXY(QUADX,QUADY) .NE. 1000) GO TO 40
	RESTING=0
	TIME=0
      GOTO 55     
 50   CALL CRAMF(REMTIME,0,2) 
      CALL CRAMDMP(16H STARDATES LEFT.) 
55    IF(CONDIT.NE.IHDOCKD) RETURN    
      IF((AITEM2-ANUM).GE.9.99) DAMAGE(14)=0   
C*--------HANDLE SPECIAL CASE OF DEATHRAY REPAIRS. 
      RETURN
 60   CALL BEGPARD
      RETURN
      END 
