      SUBROUTINE CRAMSHP
	INCLUDE 'TREKCOM/NOLIST'
	BYTE ISHIP,ESC,BELLS(16)
      EQUIVALENCE(CRACKS(1),HIT),(CRACKS(5),IESC) ,(SHIP,ISHIP)
	EQUIVALENCE (IESC,ESC)
	DATA BELLS/7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7/
      IF(ISHIP .EQ. IHE) CALL CRAM(10HENTERPRISE)
      IF(SHIP .EQ. IHF) CALL CRAM(13HFAERIE QUEENE) 
      RETURN
C* 
      ENTRY CRAM3AS 
C* 
      CALL CRAM(3H***)
      RETURN
C* 
      ENTRY STARS 
C* 
      CALL PROUT( 
     +   54H******************************************************,54) 
      RETURN
C* 
      ENTRY REDALRT 
C* 
C-------RING THE BELL BEFORE THE RED ALERT      
	CALL PROUT(BELLS,16)
      CALL PROUT(25H***RED ALERT!  RED ALERT!,25)
      RETURN
C* 
      ENTRY BEGPARD 
C* 
      CALL PROUT(27H BEG YOUR PARDON, CAPTAIN?   ,27)
      RETURN
C* 
      ENTRY MANORA
C* 
      CALL PROMPT(26HMANUAL OR AUTOMATIC?         ,26)
      RETURN
C* 
      ENTRY CASULTY 
C* 
      ICAS=HIT*RANF(0)*0.015
      IF(ICAS .LT. 2) RETURN
      CASUAL=CASUAL+ICAS
      CALL CRAM(42HMC COY:  "SICKBAY TO BRIDGE.  WE JUST HAD )
      CALL CRAMI(ICAS,0)
      CALL CRAMDMP(13H CASUALTIES.")
      RETURN
C* 
      ENTRY RESETD
C* 
      CALL NEWCOND
      IF(NENHERE .EQ. 0) RETURN 
      DO 10 L=1,NENHERE 
 10   KDIST(L)=SQRT( FLOAT((SECTX-KX(L))**2 +(SECTY-KY(L))**2)) 
      RETURN
C* 
      ENTRY LEAVE 
C* 
	KX(IESC)=KX(NENHERE)
	KY(IESC)=KY(NENHERE)
      KDIST(IESC)=KDIST(NENHERE)
      KPOWER(IESC)=KPOWER(NENHERE)
      KLHERE=KLHERE-1 
      NENHERE=NENHERE-1 
      IF(CONDIT .NE. IHDOCKD )CALL NEWCOND
      RETURN
C* 
      ENTRY SOS 
C* 
C-------- IESC PASSES WHICH KIND OF COMMANDER IS ATTACKING
	IF(ESC .EQ. IHS) GO TO 20
	ICSOS=0
	IF(DAMAGE(9) .GT. 0) RETURN 
	ICSOS=1
	IX=BATX 
	IY=BATY
	DDAY=FUTURE(5)
	GO TO 30
 20	ISSOS=0
	IF(DAMAGE(9) .GT. 0) RETURN 
	ISSOS=1
	IX=ISX 
	IY=ISY
	DDAY=FUTURE(7)
 30	CALL SKIP(1)
      CALL CRAM(37HLT. UHURA:  "CAPTAIN, THE STARBASE IN) 
      CALL CRAMLOC(1,IX,IY) 
      CALL CREND
      CALL CRAM(22H  REPORTS IT IS UNDER )
	CALL CRAMEN(ESC)
	CALL CRAMDMP(8H ATTACK.)
      CALL CRAM(32H  IT CAN SURVIVE UNTIL STARDATE )
	CALL CRAMF(DDAY     ,0,1)
	CALL CRAMDMP(3H .")
      IF(RESTING .EQ. 0) RETURN 
      CALL SKIP(1)
      CALL PROMPT(55HMR. SPOCK: CAPTAIN, SHALL WE CANCEL THE REST PERIOD
	1?      ,55)
      IF(JA(DUMMY)) RESTING=0 
      RETURN      
      END 
