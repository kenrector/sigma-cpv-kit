      SUBROUTINE ABANDON
	INCLUDE 'TREKCOM/NOLIST'
	LOGICAL*1 ISHIP
	EQUIVALENCE(ISHIP,SHIP)
      IF(DAMAGE(10)) 5,15,10
 5    IF(DAMAGE(10) .EQ. -1.) GO TO 6 
      CALL PROUT(36HSHUTTLE CRAFT NOW SERVING BIG MAC'S.,36)
	RETURN
 6    CALL PROUT(38HYE FAERIE QUEENE HAS NO SHUTTLE CRAFT.,38) 
      RETURN
 10   CALL PROUT(22HSHUTTLE CRAFT DAMAGED.,22) 
      RETURN
 15   IF((LANDED .NE. 1) .AND. (ICRAFT .NE. 1)) GO TO 16
      CALL PROUT(34HYOU MUST BE ABOARD THE ENTERPRISE.  ,34)
	RETURN
 16   IF(ISCRAFT .EQ. 1) GO TO 17 
      CALL PROUT(38HSHUTTLE CRAFT NOT CURRENTLY AVAILABLE.       ,38)
      RETURN
C--------PRINT ABANDON SHIP MESSAGES
 17   CALL SKIP(1)
      CALL PROUT(31H***ABANDON SHIP!  ABANDON SHIP!,31)    
      CALL PROUT(26H***ALL HANDS ABANDON SHIP!,26) 
      CALL SKIP(1)
      CALL PROUT( 
     +   41HCAPTAIN AND CREW ESCAPE IN SHUTTLE CRAFT.,41)
      CALL PROUT( 
     +   41HREMAINDER OF SHIP'S COMPLEMENT BEAM DOWN ,41)  
      CALL PROUT( 
     +   28HTO NEAREST HABITABLE PLANET.,28) 
C--------IF THERE ARE NO STARBASES LEFT, GAME IS OVER 
      IF(REMBASE .NE. 0) GO TO 20 
      CALL FINISH(9)
      RETURN
C--------IF THERE IS AT LEAST ONE BASE LEFT, YOU GET THE FAERIE QUEENE
 20   CALL SKIP(1)
      CALL PROUT( 
     +   44HYOU ARE CAPTURED BY KLINGONS AND RELEASED TO,44) 
      CALL PROUT( 
     +   45HTHE FEDERATION IN A PRISONER-OF-WAR EXCHANGE.,45)
      CALL PROUT( 
     +   46HSTARFLEET PUTS YOU IN COMMAND OF ANOTHER SHIP,,46) 
      CALL PROUT(42HTHE FAERIE QUEENE, WHICH IS ANTIQUATED BUT,42) 
      CALL PROUT(14HSTILL USEABLE.,14) 
C--------SELECT BASE AT WHICH TO BEGIN AGAIN
      NB=RANF(0)*REMBASE+1
C--------RESET FLAGS. 
	ICRYSTL=0
	IMINE=0
	ISCATE=0
C--------SET UP QUADRANT AND POSITION F. Q. ADJACENT TO BASE
      QUADX=BASEQX(NB)
      QUADY=BASEQY(NB)
 40   SECTX=5 
	SECTY=5
      CALL NEWQUAD
      QUAD(SECTX,SECTY)=IHDOT 
      DO 50 L=1,3 
      SECTX=3.0*RANF(0)-1.0+BASEX 
      IF(SECTX .LT. 1 .OR. SECTX .GT. 10) GO TO 50
      SECTY=3.0*RANF(0)-1.0+BASEY 
      IF(SECTY .LT. 1 .OR. SECTY .GT. 10) GO TO 50
      IF(QUAD(SECTX,SECTY) .EQ. IHDOT) GO TO 60 
 50   CONTINUE
      GO TO 40
60	ISHIP=IHF
	QUAD(SECTX,SECTY)=IHF
C--------CLEAR AND RESUPPLY SHIP
      CONDIT=IHDOCKD
      DO 70 L=1,NDEVICE 
 70   DAMAGE(L)=0 
      DAMAGE(10)=-1 
	INENRG=3000.0
	ENERGY=3000.0
	INSHLD=1250.
	SHLD=1250.0
	INTORPS=6
	TORPS=6
	INLSR=3.0
	LSUPRES=3.0
      SHLDUP=0
      WARPFAC=5.0 
      WFACSQ=25.0 
      RETURN
      END 
