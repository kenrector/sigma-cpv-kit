      SUBROUTINE MOVETHO
	INCLUDE 'TREKCOM/NOLIST'
      EQUIVALENCE (KSTUF(1),ITHERE),(KSTUF(2),ITHX),(KSTUF(3),ITHY) 
  
      IF(ITHERE.EQ.0) RETURN
      IF(JUSTIN.EQ.1) RETURN
  
      IF((ITHX.EQ.1).AND.(ITHY.EQ.1)) GO TO 10    
      IF((ITHX.EQ.1).AND.(ITHY.EQ.10))GO TO 20    
      IF((ITHX.EQ.10).AND.(ITHY.EQ.10))GOTO 30    
      IF((ITHX.EQ.10).AND.(ITHY.EQ.1))GO TO 40    
C---------SOMETHING IS VERY WRONG....GET RID OF THOLIAN.  
      ITHERE=0    
      RETURN      
        
C--------SET DESTINATION SECTOR.      
10	IDX=1
	IDY=10
	GO TO 50
20	IDX=10
	IDY=10
	GO TO 50
30	IDX=10
	IDY=1
	GO TO 50
40	IDX=1
	IDY=1
        
C----------MAKE SURE DESTINATION IS EMPTY. IF NOT, FORGET IT.       
50    IF((QUAD(IDX,IDY).NE.IHDOT).AND.(QUAD(IDX,IDY).NE.IHNUM))       
     2  RETURN    
      QUAD(ITHX,ITHY)=IHNUM 
      IF(ITHX.EQ.IDX) GO TO 120       
C----------MOVE THOLIAN ON X-AXIS     
      IM=ABS(FLOAT(IDX-ITHX))/FLOAT(IDX-ITHX)   
70    IF(ITHX.EQ.IDX) GO TO 200       
      ITHX=ITHX+IM
      IF(QUAD(ITHX,ITHY).EQ.IHDOT) QUAD(ITHX,ITHY)=IHNUM  
      GO TO 70    
120   IF(ITHY.EQ.IDY) GO TO 200       
C------------MOVE THOLIAN ON Y-AXIS.  
      IM=ABS(FLOAT(IDY-ITHY))/FLOAT(IDY-ITHY)   
130   IF(ITHY.EQ.IDY) GO TO 200       
      ITHY=ITHY+IM
      IF(QUAD(ITHX,ITHY).EQ.IHDOT) QUAD(ITHX,ITHY)=IHNUM  
      GO TO 130   
200   QUAD(ITHX,ITHY)=IHT   
C-------CHECK TO SEE IF ALL HOLES ARE PLUGED    
      DO 220 I=1,10 
      IF(QUAD(1,I).EQ.IHNUM) GO TO 205
      IF(QUAD(1,I).NE.IHT) RETURN     
205   IF(QUAD(10,I).EQ.IHNUM) GO TO 210 
      IF(QUAD(10,I).NE.IHT) RETURN    
210   IF(QUAD(I,1).EQ.IHNUM) GO TO 215
      IF(QUAD(I,1).NE.IHT) RETURN     
215   IF(QUAD(I,10).EQ.IHNUM) GO TO 220 
      IF(QUAD(I,10).NE.IHT) RETURN    
220   CONTINUE    
C-------ALL PLUGED UP, THOLIAN SPLITS.
      QUAD(ITHX,ITHY)=IHNUM 
      CALL DROPIN('@',ID1,ID2)    
      ITHERE=0    
      CALL CRMSENA(IHT,2,ITHX,ITHY)   
      CALL CRAMDMP(15H COMPLETES WEB.    )      
      RETURN      
      END 
