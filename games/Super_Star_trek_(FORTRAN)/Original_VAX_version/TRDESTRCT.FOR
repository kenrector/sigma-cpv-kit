      SUBROUTINE DESTRCT
	INCLUDE 'TREKCOM/NOLIST'
	LOGICAL*1 ISHIP
	REAL*8 IPASS,AITEM
	COMMON/SCANBF/KEY,AITEM
	EQUIVALENCE(SHIP,ISHIP)
      IF(DAMAGE(11) .EQ. 0) GO TO 5 
      CALL PROUT( 
     +   51HCOMPUTER DAMAGED; CANNOT EXECUTE DESTRUCT SEQUENCE.,51)
      RETURN
 5    CALL SKIP(1)
      CALL PROUT(13H---WORKING---,13)
      CALL PROUT(24HIDENTIFICATION-POSITIVE;,24) 
      CALL PROUT(32HSELF-DESTRUCT-SEQUENCE-ACTIVATED,32) 
      CALL PROUT( 5H   10,5)
      CALL PROUT( 8H       9,8) 
      CALL PROUT(11H          8,11)
      CALL PROUT(14H             7,14) 
      CALL PROUT(17H                6,17)
      CALL PROUT(35HENTER-CORRECT-PASSWORD-TO-CONTINUE-,35)
      CALL PROUT(33HSELF-DESTRUCT-SEQUENCE-OTHERWISE-,33)
      CALL PROMPT(40HSELF-DESTRUCT-SEQUENCE-WILL-BE-ABORTED: ,40) 
      CALL SCAN
      IF(AITEM .NE. PASSWD) GO TO 30
      CALL PROUT(17HPASSWORD-ACCEPTED,17)
      CALL PROUT(11H          5,11)
      CALL PROUT(14H             4,14) 
      CALL PROUT(17H                3,17)
      CALL PROUT(20H                   2,20) 
      CALL PROUT(23H                      1,23)
      IF(RANF(0) .LT. 0.05) CALL PROUT(19HGOODBYE-CRUEL-WORLD,19)
      CALL SKIP(2)
C* 
      ENTRY KABOOM
C* 
      CALL STARS
      IF(ISHIP .EQ. IHE) CALL CRAM3AS
      CALL CRAM(21H********* ENTROPY OF ) 
      CALL CRAMSHP
      CALL CRAMDMP(20H MAXIMIZED *********) 
      CALL STARS
      CALL SKIP(1)
      IF(NENHERE .EQ. 0) GO TO 20 
      WHAMMO=25.0*ENERGY
      DO 10 L=1,NENHERE 
      IF(KPOWER(L)*KDIST(L) .GT. WHAMMO) GOTO 10 
      II=KX(1)		!DEADKL SORTS THE KX AND KY ARRAYS AND
      JJ=KY(1)		!REDUCES THE SIZE
      CALL DEADKL(II,JJ,QUAD(II,JJ),II,JJ)
 10   CONTINUE
 20   CALL FINISH(10) 
      RETURN
 30   CALL PROUT(18HPASSWORD-REJECTED;,18) 
      CALL PROUT(19HCONTINUITY-EFFECTED,19)      
      CALL SKIP(2)
      RETURN
      END 
